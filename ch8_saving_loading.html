<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CARLsim: Chapter 8: Saving and Loading</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="CARLsimStyles.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CARLsim
   &#160;<span id="projectnumber">4.1.0</span>
   </div>
   <div id="projectbrief">CARLsim: a GPU-accelerated SNN simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ch8_saving_loading.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Chapter 8: Saving and Loading </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ch8s1_savesimulation">8.1 Saving a Simulation File</a></li>
<li class="level1"><a href="#ch8s2_loadsimulation">8.2 Loading a Simulation File</a></li>
</ul>
</div>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Kristofor D. Carlson </dd>
<dd>
Michael Beyeler</dd></dl>
<p>Once a network has reached <a class="el" href="carlsim__datastructures_8h.html#a8d0d24f2706656b1102c5e3624df65b2a033f2f21470e4f79d5dc459619a6980c" title="setup state, where the neural network is prepared for execution and monitors are set">SETUP_STATE</a> or <a class="el" href="carlsim__datastructures_8h.html#a8d0d24f2706656b1102c5e3624df65b2a67606f8f4ae6a12252ebcf0ddc2cc652" title="run state, where the model is stepped">RUN_STATE</a>, the network state can be stored in a file for later processing or for restoring a specific network using the <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file.">CARLsim::saveSimulation</a> function. The network state consists of all the synaptic connections, weights, delays, and whether the connections are plastic or fixed. The network state data can be analyzed with the MATLAB <a class="el" href="classConnectionMonitor.html" title="Class ConnectionMonitor.">ConnectionMonitor</a>.</p>
<p>Furthermore, the network state can be loaded from a file using the <a class="el" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722" title="Loads a simulation (and network state) from file. The file pointer fid must point to a valid CARLsim ...">CARLsim::loadSimulation</a> function call. However, this function can only be called in the <a class="el" href="carlsim__datastructures_8h.html#a8d0d24f2706656b1102c5e3624df65b2ac7fa385000dcb927a21b44bce4fbfca9" title="configuration state, where the neural network is configured">CONFIG_STATE</a>.</p>
<p>Saving and loading network state data can be especially time-saving when an <a class="el" href="classSNN.html" title="Contains all of CARLsim&#39;s core functionality.">SNN</a> is extremely large or if it must be trained for a long period of time. After training for the first run is completed and saved to file, subsequent testing runs will be much faster.</p>
<h1><a class="anchor" id="ch8s1_savesimulation"></a>
8.1 Saving a Simulation File</h1>
<p>A network can be saved at any time in <a class="el" href="carlsim__datastructures_8h.html#a8d0d24f2706656b1102c5e3624df65b2a033f2f21470e4f79d5dc459619a6980c" title="setup state, where the neural network is prepared for execution and monitors are set">SETUP_STATE</a> or <a class="el" href="carlsim__datastructures_8h.html#a8d0d24f2706656b1102c5e3624df65b2a67606f8f4ae6a12252ebcf0ddc2cc652" title="run state, where the model is stepped">RUN_STATE</a>, for as many times as desired, via <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file.">CARLsim::saveSimulation</a>: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="carlsim_8h.html">carlsim.h</a>&gt;</span></div>
<div class="line"><a class="code" href="classCARLsim.html">CARLsim</a> sim(<span class="stringliteral">&quot;saveSim&quot;</span>, <a class="code" href="carlsim__datastructures_8h.html#a625c4eced5cd956404990e73f3950258a729ca642c452f8a7c53df4a48f240537">CPU_MODE</a>, <a class="code" href="carlsim__datastructures_8h.html#a3a04fc42e22f436d2b3809236cb6ec54ae2d30a195cee6b2961cc2c23ea4b520b">USER</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// configure a network</span></div>
<div class="line"><span class="keywordtype">int</span> gOut = sim.<a class="code" href="classCARLsim.html#a6e11c10b6b079715074d857452c42e11">createGroup</a>(<span class="stringliteral">&quot;gOut&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line"><span class="keywordtype">int</span> gIn  = sim.<a class="code" href="classCARLsim.html#a0bf4d12b0b90740faf9a2f6a4add0351">createSpikeGeneratorGroup</a>(<span class="stringliteral">&quot;gIn&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line">sim.<a class="code" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27">connect</a>(gIn, gOut, <span class="stringliteral">&quot;one-to-one&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.1f), 0.1f);</div>
<div class="line"><span class="comment">// .. etc.</span></div>
<div class="line"> </div>
<div class="line">sim.<a class="code" href="classCARLsim.html#a6d6c298c788eeb7b18a19d82a77761b3">setupNetwork</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// save initial network</span></div>
<div class="line">sim.<a class="code" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed">saveSimulation</a>(<span class="stringliteral">&quot;networkA.dat&quot;</span>, <span class="keyword">true</span>); <span class="comment">// fileName, saveSynapseInfo</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// perform experiment, which might include synaptic plasticity and/or a training phase</span></div>
<div class="line"><span class="comment">// etc.</span></div>
<div class="line">sim.<a class="code" href="classCARLsim.html#aafb2d44405c96aafe089f96ff867018d">runNetwork</a>(1,0);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// store network at the end of training</span></div>
<div class="line">sim.<a class="code" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed">saveSimulation</a>(<span class="stringliteral">&quot;networkZ.dat&quot;</span>, <span class="keyword">true</span>); <span class="comment">// fileName, saveSynapseInfo</span></div>
</div><!-- fragment --><p> where the user specifies a filename (e.g., "networkA.dat") and a flag whether or not to store the synapse information. In this example, "networkA.dat" will contain the network state at the beginning of the experiment, and "networkZ.dat" will contain the network state at the end of the experiment (which might be different from the beginning if there is synaptic plasticity enabled). If the flag <code>saveSynapseInfo</code> is set to true, the method will store all the synaptic connections, weights, delays, and whether the connections are plastic or fixed. The value of this flag is <code>true</code> by default.</p>
<h1><a class="anchor" id="ch8s2_loadsimulation"></a>
8.2 Loading a Simulation File</h1>
<p>Past <a class="el" href="classCARLsim.html" title="CARLsim User Interface This class provides a user interface to the public sections of CARLsimCore sou...">CARLsim</a> networks can be loaded from file by setting up the same number of groups, connections, and neurons as was used to store the network via <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file.">CARLsim::saveSimulation</a>, and then calling <a class="el" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722" title="Loads a simulation (and network state) from file. The file pointer fid must point to a valid CARLsim ...">CARLsim::loadSimulation</a> to overwrite all corresponding synaptic weight and delay values from file.</p>
<p>The following code snippet configures a network and calls <a class="el" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722" title="Loads a simulation (and network state) from file. The file pointer fid must point to a valid CARLsim ...">CARLsim::loadSimulation</a> with a file pointer to "networkA.dat", which is a file that was created with <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file.">CARLsim::saveSimulation</a> and flag <code>saveSynapseInfo</code> set to <code>true</code>: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="carlsim_8h.html">carlsim.h</a>&gt;</span></div>
<div class="line"><a class="code" href="classCARLsim.html">CARLsim</a> sim(<span class="stringliteral">&quot;loadSim&quot;</span>, <a class="code" href="carlsim__datastructures_8h.html#a625c4eced5cd956404990e73f3950258a729ca642c452f8a7c53df4a48f240537">CPU_MODE</a>, <a class="code" href="carlsim__datastructures_8h.html#a3a04fc42e22f436d2b3809236cb6ec54ae2d30a195cee6b2961cc2c23ea4b520b">USER</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// configure the same network used with saveSimulation</span></div>
<div class="line"><span class="keywordtype">int</span> gOut = sim.<a class="code" href="classCARLsim.html#a6e11c10b6b079715074d857452c42e11">createGroup</a>(<span class="stringliteral">&quot;gOut&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line"><span class="keywordtype">int</span> gIn  = sim.<a class="code" href="classCARLsim.html#a0bf4d12b0b90740faf9a2f6a4add0351">createSpikeGeneratorGroup</a>(<span class="stringliteral">&quot;gIn&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line">sim.<a class="code" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27">connect</a>(gIn, gOut, <span class="stringliteral">&quot;one-to-one&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.1f), 0.1f);</div>
<div class="line"><span class="comment">// .. etc.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// before calling setupNetwork, call loadSimulation</span></div>
<div class="line">FILE* fId = NULL;</div>
<div class="line">simFid = fopen(<span class="stringliteral">&quot;networkA.dat&quot;</span>, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line">sim.<a class="code" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722">loadSimulation</a>(fId);</div>
<div class="line"><span class="comment">// don&#39;t fclose fId yet ...</span></div>
<div class="line"> </div>
<div class="line">sim.<a class="code" href="classCARLsim.html#a6d6c298c788eeb7b18a19d82a77761b3">setupNetwork</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ... wait until after setupNetwork is called</span></div>
<div class="line">fclose(fId);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// perform experiment, etc.</span></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>In order for <a class="el" href="classCARLsim.html#aeebb0912ac3497ef828e666805371722" title="Loads a simulation (and network state) from file. The file pointer fid must point to a valid CARLsim ...">CARLsim::loadSimulation</a> to work, the configured network must have the identical number of groups, connections, and neurons as the one stored with <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file.">CARLsim::saveSimulation</a>. </dd>
<dd>
In addition, <a class="el" href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed" title="Saves important simulation and network infos to file.">CARLsim::saveSimulation</a> must have been called with flag <code>saveSynapseInfo</code> set to <code>true</code>. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Wait with calling fclose on the file pointer until <a class="el" href="carlsim__datastructures_8h.html#a8d0d24f2706656b1102c5e3624df65b2a033f2f21470e4f79d5dc459619a6980c" title="setup state, where the neural network is prepared for execution and monitors are set">SETUP_STATE</a>! </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="aclassCARLsim_html_a0bf4d12b0b90740faf9a2f6a4add0351"><div class="ttname"><a href="classCARLsim.html#a0bf4d12b0b90740faf9a2f6a4add0351">CARLsim::createSpikeGeneratorGroup</a></div><div class="ttdeci">int createSpikeGeneratorGroup(const std::string &amp;grpName, int nNeur, int neurType, int preferredPartition=ANY, ComputingBackend preferredBackend=CPU_CORES)</div><div class="ttdoc">creates a spike generator group</div><div class="ttdef"><b>Definition:</b> <a href="carlsim_8cpp_source.html#l01779">carlsim.cpp:1779</a></div></div>
<div class="ttc" id="astructRangeWeight_html"><div class="ttname"><a href="structRangeWeight.html">RangeWeight</a></div><div class="ttdoc">a range struct for synaptic weight magnitudes</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__datastructures_8h_source.html#l00311">carlsim_datastructures.h:311</a></div></div>
<div class="ttc" id="aclassCARLsim_html_aafb2d44405c96aafe089f96ff867018d"><div class="ttname"><a href="classCARLsim.html#aafb2d44405c96aafe089f96ff867018d">CARLsim::runNetwork</a></div><div class="ttdeci">int runNetwork(int nSec, int nMsec=0, bool printRunSummary=true)</div><div class="ttdoc">run the simulation for time=(nSec*seconds + nMsec*milliseconds)</div><div class="ttdef"><b>Definition:</b> <a href="carlsim_8cpp_source.html#l01909">carlsim.cpp:1909</a></div></div>
<div class="ttc" id="aclassCARLsim_html_a3b08150d9a98f80df57852450c0d87ed"><div class="ttname"><a href="classCARLsim.html#a3b08150d9a98f80df57852450c0d87ed">CARLsim::saveSimulation</a></div><div class="ttdeci">void saveSimulation(const std::string &amp;fileName, bool saveSynapseInfo=true)</div><div class="ttdoc">Saves important simulation and network infos to file.</div><div class="ttdef"><b>Definition:</b> <a href="carlsim_8cpp_source.html#l01922">carlsim.cpp:1922</a></div></div>
<div class="ttc" id="acarlsim__definitions_8h_html_a71b1b059a7ff0783d39e22b9b1028d90"><div class="ttname"><a href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a></div><div class="ttdeci">#define EXCITATORY_NEURON</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__definitions_8h_source.html#l00077">carlsim_definitions.h:76</a></div></div>
<div class="ttc" id="acarlsim__datastructures_8h_html_a3a04fc42e22f436d2b3809236cb6ec54ae2d30a195cee6b2961cc2c23ea4b520b"><div class="ttname"><a href="carlsim__datastructures_8h.html#a3a04fc42e22f436d2b3809236cb6ec54ae2d30a195cee6b2961cc2c23ea4b520b">USER</a></div><div class="ttdeci">@ USER</div><div class="ttdoc">User mode, for experiment-oriented simulations.</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__datastructures_8h_source.html#l00091">carlsim_datastructures.h:91</a></div></div>
<div class="ttc" id="aclassCARLsim_html_a6d6c298c788eeb7b18a19d82a77761b3"><div class="ttname"><a href="classCARLsim.html#a6d6c298c788eeb7b18a19d82a77761b3">CARLsim::setupNetwork</a></div><div class="ttdeci">void setupNetwork()</div><div class="ttdoc">build the network</div><div class="ttdef"><b>Definition:</b> <a href="carlsim_8cpp_source.html#l01914">carlsim.cpp:1914</a></div></div>
<div class="ttc" id="acarlsim__datastructures_8h_html_a625c4eced5cd956404990e73f3950258a729ca642c452f8a7c53df4a48f240537"><div class="ttname"><a href="carlsim__datastructures_8h.html#a625c4eced5cd956404990e73f3950258a729ca642c452f8a7c53df4a48f240537">CPU_MODE</a></div><div class="ttdeci">@ CPU_MODE</div><div class="ttdoc">model is run on CPU core(s)</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__datastructures_8h_source.html#l00114">carlsim_datastructures.h:114</a></div></div>
<div class="ttc" id="aclassCARLsim_html"><div class="ttname"><a href="classCARLsim.html">CARLsim</a></div><div class="ttdoc">CARLsim User Interface This class provides a user interface to the public sections of CARLsimCore sou...</div><div class="ttdef"><b>Definition:</b> <a href="carlsim_8h_source.html#l00137">carlsim.h:137</a></div></div>
<div class="ttc" id="aclassCARLsim_html_a30b16b93d57551dcde0559e8a4e98e27"><div class="ttname"><a href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27">CARLsim::connect</a></div><div class="ttdeci">short int connect(int grpId1, int grpId2, const std::string &amp;connType, const RangeWeight &amp;wt, float connProb, const RangeDelay &amp;delay=RangeDelay(1), const RadiusRF &amp;radRF=RadiusRF(-1.0), bool synWtType=SYN_FIXED, float mulSynFast=1.0f, float mulSynSlow=1.0f)</div><div class="ttdoc">Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...</div><div class="ttdef"><b>Definition:</b> <a href="carlsim_8cpp_source.html#l01739">carlsim.cpp:1739</a></div></div>
<div class="ttc" id="acarlsim_8h_html"><div class="ttname"><a href="carlsim_8h.html">carlsim.h</a></div></div>
<div class="ttc" id="aclassCARLsim_html_aeebb0912ac3497ef828e666805371722"><div class="ttname"><a href="classCARLsim.html#aeebb0912ac3497ef828e666805371722">CARLsim::loadSimulation</a></div><div class="ttdeci">void loadSimulation(FILE *fid)</div><div class="ttdoc">Loads a simulation (and network state) from file. The file pointer fid must point to a valid CARLsim ...</div><div class="ttdef"><b>Definition:</b> <a href="carlsim_8cpp_source.html#l01941">carlsim.cpp:1941</a></div></div>
<div class="ttc" id="aclassCARLsim_html_a6e11c10b6b079715074d857452c42e11"><div class="ttname"><a href="classCARLsim.html#a6e11c10b6b079715074d857452c42e11">CARLsim::createGroup</a></div><div class="ttdeci">int createGroup(const std::string &amp;grpName, int nNeur, int neurType, int preferredPartition=ANY, ComputingBackend preferredBackend=CPU_CORES)</div><div class="ttdoc">creates a group of Izhikevich spiking neurons</div><div class="ttdef"><b>Definition:</b> <a href="carlsim_8cpp_source.html#l01763">carlsim.cpp:1763</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Jul 11 2020 19:24:13 for CARLsim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
