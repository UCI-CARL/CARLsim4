<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CARLsim: Chapter 4: Connections</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="CARLsimStyles.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CARLsim
   &#160;<span id="projectnumber">4.1.0</span>
   </div>
   <div id="projectbrief">CARLsim: a GPU-accelerated SNN simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ch4_connections.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Chapter 4: Connections </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ch4s1_primitive_types">4.1 Primitive Types</a><ul><li class="level2"><a href="#ch4s1s1_range_weight">4.1.1 The RangeWeight Struct</a></li>
<li class="level2"><a href="#ch4s1s2_range_delay">4.1.2 The RangeDelay Struct</a></li>
<li class="level2"><a href="#ch4s1s3_radiusRF">4.1.3 The RadiusRF Struct</a></li>
<li class="level2"><a href="#ch4s1s4_receptor_gain">4.1.4 Synaptic Receptor-Specific Gain Factors</a></li>
<li class="level2"><a href="#ch4s1s5_full">4.1.5 All-to-All Connectivity</a></li>
<li class="level2"><a href="#ch4s1s6_random">4.1.6 Random Connectivity</a></li>
<li class="level2"><a href="#ch4s1s7_1to1">4.1.7 One-to-One Connectivity</a></li>
<li class="level2"><a href="#ch4s1s8_gaussian">4.1.8 Gaussian Connectivity</a></li>
<li class="level2"><a href="#ch4s1s9_compconn">4.1.9 Compartmental Connections</a></li>
</ul>
</li>
<li class="level1"><a href="#ch4s2_library_tools">4.2. Library Tools</a></li>
<li class="level1"><a href="#ch4s3_user_defined">4.3 User-Defined Connections</a></li>
<li class="level1"><a href="#ch4s4_migrating_connect">4.4 Migrating from CARLsim 2.2</a></li>
</ul>
</div>
<div class="textblock"><p>Once the neuron groups have been defined, the synaptic connections between them can be defined via <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a>. <a class="el" href="classCARLsim.html" title="CARLsim User Interface This class provides a user interface to the public sections of CARLsimCore sou...">CARLsim</a> provides a set of primitive connection topologies for building networks as well as a means to specify arbitrary connectivity using a callback mechanism. The following sections will explain this functionality in detail.</p>
<p>For users migrating from <a class="el" href="classCARLsim.html" title="CARLsim User Interface This class provides a user interface to the public sections of CARLsimCore sou...">CARLsim</a> 2.2, please note that the signature of the <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> call has changed (see <a class="el" href="ch4_connections.html#ch4s4_migrating_connect">4.4 Migrating from CARLsim 2.2</a>).</p>
<h1><a class="anchor" id="ch4s1_primitive_types"></a>
4.1 Primitive Types</h1>
<dl class="section author"><dt>Author</dt><dd>Michael Beyeler</dd></dl>
<p><a class="el" href="classCARLsim.html" title="CARLsim User Interface This class provides a user interface to the public sections of CARLsimCore sou...">CARLsim</a> provides a number of pre-defined connection types: All-to-all, random, one-to-one, and Gaussian connectivity. All-to-all (also known as "full") connectivity connects all neurons in the pre-synaptic group to all neurons in the post-synaptic group (with or without self-connections). One-to-one connectivity connects neuron i in the pre-synaptic group to neuron i in the post-synaptic group (both groups should have the same number of neurons). Random connectivity connects a group of pre-synaptic neurons randomly to a group of post-synaptic neurons with a user-specified probability p. Gaussian connectivity uses topographic information from the <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D</a> struct to connects neurons based on their relative distance in 3D space.</p>
<p>Pre-defined connection types are specified using <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a>, which in their complete form look like the following: </p><div class="fragment"><div class="line"><span class="keywordtype">short</span> <span class="keywordtype">int</span> cId = sim.connect(grpIdPre, grpIdPost, type, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.0f,0.1f,0.2f), 0.5f, <a class="code" href="structRangeDelay.html">RangeDelay</a>(1,10),</div>
<div class="line">    <a class="code" href="structRadiusRF.html">RadiusRF</a>(3,3,0), <a class="code" href="carlsim__definitions_8h.html#a9baa3423c83e97f02e68daccf466ed4d">SYN_PLASTIC</a>, 1.5f, 0.5f);</div>
</div><!-- fragment --><p> Here, a pre-synaptic group with ID <code>grpIdPre</code> is connected to a post-synaptic group with ID <code>grpIdPost</code> following a given connection probability of 50% (0.5f) and a specific connection <code>type</code>, the latter being a string such as "full", "one-to-one", "random", etc. The synapse type (either fixed or plastic) can be indicated with the keyword <code>SYN_FIXED</code> or <code>SYN_PLASTIC</code>. In COBA Mode, receptor-specific gain factors can be specified for fast (1.5f) and slow channels (0.5f), which map either to AMPA and NMDA for excitatory connections, or GABAa and GABAb for inhibitory connections (see <a class="el" href="ch4_connections.html#ch4s1s4_receptor_gain">4.1.4 Synaptic Receptor-Specific Gain Factors</a>).</p>
<p>Also, this method makes use of three different structs that aim to simplify the specification of weight ranges (<a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight</a>, explained in <a class="el" href="ch4_connections.html#ch4s1s1_range_weight">4.1.1 The RangeWeight Struct</a>), delay ranges (<a class="el" href="structRangeDelay.html" title="a range struct for synaptic delays">RangeDelay</a>, explained in <a class="el" href="ch4_connections.html#ch4s1s2_range_delay">4.1.2 The RangeDelay Struct</a>), and spatial receptive fields (<a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a>, explained in <a class="el" href="ch4_connections.html#ch4s1s3_radiusRF">4.1.3 The RadiusRF Struct</a>).</p>
<p>The simplest <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> call that uses default values for all optional arguments reads as follows: </p><div class="fragment"><div class="line">sim.connect(grpIdPre, grpIdPost, type, <a class="code" href="structRangeWeight.html">RangeWeight</a>(wt), prob);</div>
</div><!-- fragment --><p> This will connect <code>grpIdPre</code> to <code>grpIdPost</code> with connection type <code>type</code> and connection probability <code>prob</code>, using fixed synapses, 1ms delay, no spatial receptive fields, and synaptic gain factor 1.0f.</p>
<h2><a class="anchor" id="ch4s1s1_range_weight"></a>
4.1.1 The RangeWeight Struct</h2>
<p><a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight</a> is a struct that simplifies the specification of the lower bound (<a class="el" href="structRangeWeight.html#aad36546e8175d2922bee165fe028fedc">RangeWeight.min</a>) and upper bound (<a class="el" href="structRangeWeight.html#a0b0ede69e8156eb97acc579b88e883de">RangeWeight.max</a>) of the weights as well as an initial weight value (<a class="el" href="structRangeWeight.html#a10898f33c154eac05db95d6268c611bc">RangeWeight.init</a>). For fixed synapses (no plasticity) these three values are all the same. In this case, it is sufficient to call the struct with a single value <code>wt</code>: <code><a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight(wt)</a></code>. This will set all fields of the struct to value <code>wt</code>.</p>
<p>On the other hand, plastic synapses are initialized to <a class="el" href="structRangeWeight.html#a10898f33c154eac05db95d6268c611bc">RangeWeight.init</a>, and can range between <a class="el" href="structRangeWeight.html#aad36546e8175d2922bee165fe028fedc">RangeWeight.min</a> and <a class="el" href="structRangeWeight.html#a0b0ede69e8156eb97acc579b88e883de">RangeWeight.max</a>.</p>
<p>Note that all specified weights are considered weight <b>magnitudes</b> and should thus be non-negative, even for inhibitory connections.</p>
<p>The following code snippet would fully connect neuron group <code>grpIdPre</code> to <code>grpIdPost</code> with plastic synapses in the range 0.0f and 0.2f, initialized to 0.1f, connection probability 1 (100%), with no particular spatial receptive field, and 1ms synaptic delay: </p><div class="fragment"><div class="line"><span class="keywordtype">short</span> <span class="keywordtype">int</span> cId = sim.connect(grpIdPre, grpIdPost, <span class="stringliteral">&quot;full&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.0f,0.1f,0.2f), 1.0f, <a class="code" href="structRangeDelay.html">RangeDelay</a>(1),</div>
<div class="line">    <a class="code" href="structRadiusRF.html">RadiusRF</a>(-1), <a class="code" href="carlsim__definitions_8h.html#a9baa3423c83e97f02e68daccf466ed4d">SYN_PLASTIC</a>);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>All specified weight values should be non-negative (equivalent to weight <b>magnitudes</b>), even for inhibitory connections. </dd>
<dd>
The lower bound for weight values (<a class="el" href="structRangeWeight.html#aad36546e8175d2922bee165fe028fedc">RangeWeight.min</a>) must be zero. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="ch4_connections.html#ch4s4_migrating_connect">4.4 Migrating from CARLsim 2.2</a> </dd></dl>
<dl class="section since"><dt>Since</dt><dd>v3.0</dd></dl>
<h2><a class="anchor" id="ch4s1s2_range_delay"></a>
4.1.2 The RangeDelay Struct</h2>
<p>Similar to <a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight</a>, <a class="el" href="structRangeDelay.html" title="a range struct for synaptic delays">RangeDelay</a> is a struct to specify the lower bound (<a class="el" href="structRangeDelay.html#a3e202b201e6255d975cd6d3aff1f5a4d">RangeDelay.min</a>) and upper bound (<a class="el" href="structRangeDelay.html#ae1e1dde676c120fa6d10f3bb2c14059e">RangeDelay.max</a>) of a synaptic delay range. Synaptic delays are measured in milliseconds, and can only take integer values.</p>
<p>The following code snippet would fully connect neuron group <code>grpIdPre</code> to <code>grpIdPost</code> with fixed synapses (weight is 0.25f), connection probability 1 (100%), no particular spatial receptive field, and synaptic delays that are uniformly distributed between 1ms and 20ms: </p><div class="fragment"><div class="line"><span class="keywordtype">short</span> <span class="keywordtype">int</span> cId = sim.connect(grpIdPre, grpIdPost, <span class="stringliteral">&quot;full&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.25f), 1.0f, <a class="code" href="structRangeDelay.html">RangeDelay</a>(1,20),</div>
<div class="line">    <a class="code" href="structRadiusRF.html">RadiusRF</a>(-1), <a class="code" href="carlsim__definitions_8h.html#a40e0573abfe33884cbdaae75b5971955">SYN_FIXED</a>);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Delays have to be in the range [1ms, 20ms]. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>v3.0</dd></dl>
<h2><a class="anchor" id="ch4s1s3_radiusRF"></a>
4.1.3 The RadiusRF Struct</h2>
<p>Each connection type can make use of an optional <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a> struct to specify circular receptive fields (RFs) in 1D, 2D, or 3D, following the topographic organization of the <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D</a> struct (see <a class="el" href="ch3_neurons_synapses_groups.html#ch3s3s2_topography">3.3.2 Topography</a>). This allows for the creation of networks with complex spatial structure.</p>
<p>Spatial RFs are always specified from the point of view of a post-synaptic neuron at location (post.x,post.y,post.z), looking back on all the pre-synaptic neurons at location (pre.x,pre.y,pre.z) it is connected to.</p>
<p>Using the <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D</a> struct, neurons in a group can be arranged into a (up to) three-dimensional (primitive cubic) grid with side length 1 (arbitrary units). Each neuron in the group gets assigned a (x,y,z) location on a 3D grid centered around the origin, so that calling <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D(Nx,Ny,Nz)</a> creates coordinates that fall in the range [-(Nx-1)/2, (Nx-1)/2], [-(Ny-1)/2, (Ny-1)/2], and [-(Nz-1)/2, (Nz-1)/2]. For more information on the <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D</a> struct, please refer to <a class="el" href="ch3_neurons_synapses_groups.html#ch3s3s2_topography">3.3.2 Topography</a>.</p>
<p>The <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a> struct follows the spatial arrangement (and arbitrary units) established by <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D</a>. The struct takes up to three arguments, which specify the radius of a circular receptive field in x, y, and z. If the radius in one dimension is 0, say <a class="el" href="structRadiusRF.html#a521d27bf4763116d92a74efce4be6942">RadiusRF.radX</a>==0, then pre.x must be equal to post.x in order to be connected. If the radius in one dimension is -1, say <a class="el" href="structRadiusRF.html#a521d27bf4763116d92a74efce4be6942">RadiusRF.radX</a>==-1, then pre and post will be connected no matter their specific pre.x and post.x Otherwise, if the radius in one dimension is a positive real number, the RF radius will be exactly that number.</p>
<p>Examples:</p><ul>
<li>Create a 2D Gaussian RF of radius 10 in z-plane: <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF(10, 10, 0)</a> Neuron pre will be connected to neuron post iff (pre.x-post.x)^2 + (pre.y-post.y)^2 &lt;= 100 and pre.z==post.z.</li>
<li>Create a 2D heterogeneous Gaussian RF (an ellipse) with semi-axes 10 and 5: <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF(10, 5, 0)</a> Neuron pre will be connected to neuron post iff (pre.x-post.x)/100 + (pre.y-post.y)^2/25 &lt;= 1 and pre.z==post.z.</li>
<li>Connect all, no matter the RF (default): <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a>(-1, -1, -1)</li>
<li>Connect one-to-one: <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF(0, 0, 0)</a> Neuron pre will be connected to neuron post iff pre.x==post.x, pre.y==post.y, pre.z==post.z. Note: Use <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> with type "one-to-one" instead.</li>
</ul>
<div class="image">
<img src="4_radiusRF.jpg" alt=""/>
<div class="caption">
Examples of 2D receptive fields (topographic heatmap of weight strengths) generated with RadiusRF and CARLsim::connect.</div></div>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="ch3_neurons_synapses_groups.html#ch3s3s2_topography">3.3.2 Topography</a> </dd></dl>
<dl class="section since"><dt>Since</dt><dd>v3.0</dd></dl>
<h2><a class="anchor" id="ch4s1s4_receptor_gain"></a>
4.1.4 Synaptic Receptor-Specific Gain Factors</h2>
<p>In COBA Mode (see <a class="el" href="ch3_neurons_synapses_groups.html#ch3s2s2_coba">3.2.2 COBA</a>), synaptic receptor-specific gain factors can be specified to vary the AMPA-NMDA and GABAa-GABAb ratios.</p>
<p>The <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> method takes two additional parameters at the very end, which indicate a multiplicative gain factor for fast and slow synaptic channels. The following code snippet would fully connect neuron group <code>grpIdPre</code> to <code>grpIdPost</code> with fixed synapses (weight is 0.25f, all delays are 1ms) and gain factor 1.5f for fast and 0.5f for slow synaptic channels: </p><div class="fragment"><div class="line"><span class="keywordtype">short</span> <span class="keywordtype">int</span> cId = sim.connect(grpIdPre, grpIdPost, <span class="stringliteral">&quot;full&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.25f), 1.0f, <a class="code" href="structRangeDelay.html">RangeDelay</a>(1),</div>
<div class="line">    <a class="code" href="structRadiusRF.html">RadiusRF</a>(-1), <a class="code" href="carlsim__definitions_8h.html#a40e0573abfe33884cbdaae75b5971955">SYN_FIXED</a>, 1.5f, 0.5f);</div>
</div><!-- fragment --><p>If the post-synaptic neuron is of type <a class="el" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a> (<a class="el" href="carlsim__definitions_8h.html#a1f1973192224715d2362de045a5c6387">INHIBITORY_NEURON</a>), then the fast channel will refer to AMPA (GABAa) and the slow channel will refer to NMDA (GABAb).</p>
<dl class="section note"><dt>Note</dt><dd>The default gain factors (if not specified) are 1.0f for both fast and slow channels. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>v3.0</dd></dl>
<h2><a class="anchor" id="ch4s1s5_full"></a>
4.1.5 All-to-All Connectivity</h2>
<p>All-to-all (also known as "full") connectivity connects all neurons in the pre-synaptic group to all neurons in the post-synaptic group (with or without self-connections).</p>
<p>The easiest way to achieve all-to-all connectivity with a fixed weight (e.g., 0.25f), a fixed connection probability (e.g., 0.1f or 10%), and 1ms synaptic delay is via the following <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> command: </p><div class="fragment"><div class="line"><span class="keywordtype">short</span> <span class="keywordtype">int</span> cId = sim.connect(gIn, gOut, <span class="stringliteral">&quot;full&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.25f), 0.1f);</div>
</div><!-- fragment --><p> Here, <code>gIn</code> and <code>gOut</code> are group IDs returned from a call to <a class="el" href="classCARLsim.html#a0bf4d12b0b90740faf9a2f6a4add0351" title="creates a spike generator group">CARLsim::createSpikeGeneratorGroup</a> or <a class="el" href="classCARLsim.html#a6e11c10b6b079715074d857452c42e11" title="creates a group of Izhikevich spiking neurons">CARLsim::createGroup</a> (see <a class="el" href="ch3_neurons_synapses_groups.html#ch3s3_groups">3.3 Groups</a>). The keyword "full" indicates all-to-all connectivity. <a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight</a> is a struct that simplifies the specification of minimum, initial, and maximum weight values. The last parameter, <code>0.1f</code>, sets the connection probability to 10%. All other parameters (such as synaptic delays, receptive field structure, and synapse type) are optional&mdash;thus by omitting them default values are used. The function returns a connection ID, <code>cId</code>, which can be used to reference the connection in subsequent calls; for example, when setting up a <a class="el" href="classConnectionMonitor.html" title="Class ConnectionMonitor.">ConnectionMonitor</a> (see <a class="el" href="ch7_monitoring.html#ch7s2_connection_monitor">7.2 Connection Monitor</a>).</p>
<p>Alternatively, while connecting a group to itself with a recurrent connection, one can use the "full-no-direct" keyword to indicate that no self-connections shall be made. If two different groups are connected with this connection type, the connection will be equivalent to a full connection.</p>
<div class="fragment"><div class="line"><span class="keywordtype">short</span> <span class="keywordtype">int</span> cId = sim.connect(gIn, gIn, <span class="stringliteral">&quot;full-no-direct&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.25f), 0.1f);</div>
</div><!-- fragment --><p> This will prevent neuron <code>i</code> in the pre-synaptic group to be connected to neuron <code>i</code> in the post-synaptic group, if the pre and post synaptic groups are the same.</p>
<h2><a class="anchor" id="ch4s1s6_random"></a>
4.1.6 Random Connectivity</h2>
<p>Random connectivity connects a group of pre-synaptic neurons randomly to a group of post-synaptic neurons with a user-specified probability p.</p>
<p>The easiest way to achieve uniform random connectivity with a fixed weight (e.g., 0.25f), a fixed connection probability (e.g., 0.1f or 10%), and 1ms synaptic delay is via the following <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> command: </p><div class="fragment"><div class="line"><span class="keywordtype">short</span> <span class="keywordtype">int</span> cId = sim.connect(gIn, gOut, <span class="stringliteral">&quot;random&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.25f), 0.1f);</div>
</div><!-- fragment --><p> Here, <code>gIn</code> and <code>gOut</code> are group IDs returned from a call to <a class="el" href="classCARLsim.html#a0bf4d12b0b90740faf9a2f6a4add0351" title="creates a spike generator group">CARLsim::createSpikeGeneratorGroup</a> or <a class="el" href="classCARLsim.html#a6e11c10b6b079715074d857452c42e11" title="creates a group of Izhikevich spiking neurons">CARLsim::createGroup</a> (see <a class="el" href="ch3_neurons_synapses_groups.html#ch3s3_groups">3.3 Groups</a>). The keyword "random" indicates uniform random connectivity. <a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight</a> is a struct that simplifies the specification of minimum, initial, and maximum weight values. The last parameter, <code>0.1f</code>, sets the connection probability to 10%. All other parameters (such as synaptic delays, receptive field structure, and synapse type) are optional&mdash;thus by omitting them default values are used. The function returns a connection ID, <code>cId</code>, which can be used to reference the connection in subsequent calls; for example, when setting up a <a class="el" href="classConnectionMonitor.html" title="Class ConnectionMonitor.">ConnectionMonitor</a> (see <a class="el" href="ch7_monitoring.html#ch7s2_connection_monitor">7.2 Connection Monitor</a>).</p>
<h2><a class="anchor" id="ch4s1s7_1to1"></a>
4.1.7 One-to-One Connectivity</h2>
<p>One-to-one connectivity connects neuron i in the pre-synaptic group to neuron i in the post-synaptic group (both groups should have the same number of neurons).</p>
<p>The easiest way to achieve one-to-one connectivity with a fixed weight (e.g., 0.25f), connection probability 1 (100%), and 1ms synaptic delay is via the following <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> command: </p><div class="fragment"><div class="line"><span class="keywordtype">short</span> ind cId = sim.connect(gIn, gOut, <span class="stringliteral">&quot;one-to-one&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.25f), 1.0f);</div>
</div><!-- fragment --><p> Here, <code>gIn</code> and <code>gOut</code> are group IDs returned from a call to <a class="el" href="classCARLsim.html#a0bf4d12b0b90740faf9a2f6a4add0351" title="creates a spike generator group">CARLsim::createSpikeGeneratorGroup</a> or <a class="el" href="classCARLsim.html#a6e11c10b6b079715074d857452c42e11" title="creates a group of Izhikevich spiking neurons">CARLsim::createGroup</a> (see <a class="el" href="ch3_neurons_synapses_groups.html#ch3s3_groups">3.3 Groups</a>). The keyword "one-to-one" indicates one-to-one connectivity. <a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight</a> is a struct that simplifies the specification of minimum, initial, and maximum weight values. The last parameter, <code>1.0f</code>, sets the connection probability to 100%. All other parameters (such as synaptic delays, receptive field structure, and synapse type) are optional&mdash;thus by omitting them default values are used. The function returns a connection ID, <code>cId</code>, which can be used to reference the connection in subsequent calls; for example, when setting up a <a class="el" href="classConnectionMonitor.html" title="Class ConnectionMonitor.">ConnectionMonitor</a> (see <a class="el" href="ch7_monitoring.html#ch7s2_connection_monitor">7.2 Connection Monitor</a>).</p>
<dl class="section note"><dt>Note</dt><dd>In order to achieve topographic one-to-one connectivity (i.e., connect two neurons only if they code for the same spatial location), use Gaussian connectivity with <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF(0,0,0)</a>.</dd></dl>
<h2><a class="anchor" id="ch4s1s8_gaussian"></a>
4.1.8 Gaussian Connectivity</h2>
<p>Gaussian connectivity uses topographic information from the <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D</a> struct to connect neurons based on their relative distance in 3D space. The extent of the Gaussian neighborhood is specified via the <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a> struct, which accepts three parameters to specify a receptive field radius in dimensions x, y, and z. This makes it possible to create 1D, 2D, or 3D circular receptive fields.</p>
<p>The easiest way to achieve 2D Gaussian connectivity with radius 10 (arbitrary units) in x and y, where synaptic weights are fixed and decrease with distance, connection probability is 1 (100%), and synaptic delays are 1ms, is via the following <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> command: </p><div class="fragment"><div class="line"><span class="keywordtype">short</span> <span class="keywordtype">int</span> cId = sim.connect(gIn, gOut, <span class="stringliteral">&quot;gaussian&quot;</span>, <a class="code" href="structRangeWeight.html">RangeWeight</a>(0.25f), 1.0f, <a class="code" href="structRangeDelay.html">RangeDelay</a>(1), <a class="code" href="structRadiusRF.html">RadiusRF</a>(10,10,0), <a class="code" href="carlsim__definitions_8h.html#a40e0573abfe33884cbdaae75b5971955">SYN_FIXED</a>);</div>
</div><!-- fragment --><p> Here, <code>gIn</code> and <code>gOut</code> are group IDs returned from a call to <a class="el" href="classCARLsim.html#a0bf4d12b0b90740faf9a2f6a4add0351" title="creates a spike generator group">CARLsim::createSpikeGeneratorGroup</a> or <a class="el" href="classCARLsim.html#a6e11c10b6b079715074d857452c42e11" title="creates a group of Izhikevich spiking neurons">CARLsim::createGroup</a> (see <a class="el" href="ch3_neurons_synapses_groups.html#ch3s3_groups">3.3 Groups</a>). The keyword "gaussian" indicates Gaussian connectivity. <a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight</a> is a struct that simplifies the specification of minimum, initial, and maximum weight values; and in this case it specifies the maximum weight value, which is achieved when both pre-synaptic and post-synaptic neuron code for the same spatial location. The next parameter, <code>1.0f</code>, sets the connection probability to 100%. <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF(10,10,0)</a> specifies that a 2D receptive fields in x and y shall be created with radius 10 (see example below). Setting radius in z to 0 forces neurons to have the exact same z-coordinate in order to be connected. The function returns a connection ID, <code>cId</code>, which can be used to reference the connection in subsequent calls; for example, when setting up a <a class="el" href="classConnectionMonitor.html" title="Class ConnectionMonitor.">ConnectionMonitor</a> (see <a class="el" href="ch7_monitoring.html#ch7s2_connection_monitor">7.2 Connection Monitor</a>).</p>
<p>A few things should be noted about the implementation. Usually, one specifies the Gaussian width or standard deviation of the normal distribution (i.e., the parameter <img class="formulaInl" alt="$\sigma$" src="form_57.png" width="10" height="8"/>). Here, in order to standardize <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> calls across connection types, the Gaussian width is instead inferred from the <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a> structs, such that neurons at the very border of the receptive field are connected with a weight that is 10% of the maximum specified weight. Within the receptive field weights drop with distance squared, as is the case with a regular normal distribution. Note that units for distance are arbitrary, in that they are not tied to any physical unit of space. Instead, units are tied to the <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D</a> struct, which places consecutive neurons 1 arbitrary unit apart.</p>
<p><b>Example:</b> Consider a 2D receptive field <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF(a,b,0)</a>. Here, two neurons "pre" and "post", coding for spatial locations (pre.x,pre.y,pre.z) and (post.x,post.y,post.z), will be connected iff <img class="formulaInl" alt="$ (pre.x-post.x)^2/a^2 + (pre.y-post.y)/b^2 &lt;= 1 $" src="form_58.png" width="338" height="20"/> (which is the ellipse inequality) and <img class="formulaInl" alt="$pre.z==post.z$" src="form_59.png" width="114" height="15"/>. The weight will be maximal (i.e., <code><a class="el" href="structRangeWeight.html#a0b0ede69e8156eb97acc579b88e883de">RangeWeight.max</a></code>) if "pre" and "post" code for the same (x,y) location. Within the receptive field, the weights drop with distance squared, so that neurons for which <img class="formulaInl" alt="$ (pre.x-post.x)^2/a^2 + (pre.y-post.y)/b^2 == 1$" src="form_60.png" width="338" height="20"/> (exactly equal to 1) are connected with <code>0.1*RangeWeight.max</code>. Outside the receptive field, weights are zero.</p>
<p>Another case to consider is where the presynaptic and postsynaptic group have different <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D</a> structs (or consist of different numbers of neurons). In order to cover the full space that these groups cover, the coordinate of the presynaptic group will be scaled to the dimensions of the postsynaptic group: <img class="formulaInl" alt="$ pre.x = pre.x / gridPre.x * gridPost.x $" src="form_61.png" width="270" height="18"/>, <img class="formulaInl" alt="$ pre.y = pre.y / gridPre.y * gridPost.y $" src="form_62.png" width="267" height="18"/>, and <img class="formulaInl" alt="$ pre.z = pre.z / gridPre.z * gridPost.z $" src="form_63.png" width="267" height="18"/>.</p>
<p>The following figures shows some of examples of a 2D Gaussian receptive field created with <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF(9,9,0)</a>. Each panel shows the receptive field of a particular post-synaptic neuron (coding for different spatial locations) looking back at its pre-synaptic connections. The figure was generated with an OAT Connection Monitor (see <a class="el" href="ch9_matlab_oat.html">Chapter 9: MATLAB Offline Analysis Toolbox (OAT)</a>).</p>
<div class="image">
<img src="4_gauss2D.jpg" alt=""/>
<div class="caption">
Examples of 2D Gaussian receptive fields (topographic heatmap of weight strengths).</div></div>
<p>By making use of the flexibility that is provided by the <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a> struct, it is possible to create any 1D, 2D, or 3D Gaussian receptive field. A few examples that are easy to visualize are shown in the figure below. The first panel is essentially a one-to-one connection by using <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF(0,0,0)</a>. But, assume you would want to connect neurons only if their (x,y) location is the same, but did not care about their z-coordinates. This could simply be achieved by using <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a>(0,0,-1). Similary, it is possible to permute the x, y, and z dimensions in the logic. You could connect neurons according to distance in y, only if their z-coordinate was the same, no matter the x-coordinate: <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a>(-1,y,0). Or, you could connect neurons in a 3D ellipsoid: <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF(a,b,c)</a>.</p>
<div class="image">
<img src="4_gaussVariety.jpg" alt=""/>
<div class="caption">
Examples of Gaussian receptive fields with complex RadiusRF.</div></div>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a> and <a class="el" href="structGrid3D.html" title="A struct to arrange neurons on a 3D grid (a primitive cubic Bravais lattice with cubic side length 1)">Grid3D</a> use the same but arbitrary units, where neurons are placed on a (primitive cubic) grid with cubic side length 1, so that consecutive neurons on the grid are placed 1 arbitrary unit apart. </dd>
<dd>
Any 1D, 2D, or 3D Gaussian receptive field is possible. However, visualization is currently limited to 2D planes. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Since the Gaussian width is inferred from receptive field dimensions, using "gaussian" connectivity in combination with <a class="el" href="structRadiusRF.html" title="A struct to specify the receptive field (RF) radius in 3 dimensions.">RadiusRF</a>(-1,-1,-1) is not allowed.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="ch3_neurons_synapses_groups.html#ch3s3s2_topography">3.3.2 Topography</a> </dd>
<dd>
<a class="el" href="ch4_connections.html#ch4s1s3_radiusRF">4.1.3 The RadiusRF Struct</a> </dd></dl>
<dl class="section since"><dt>Since</dt><dd>v3.0</dd></dl>
<h2><a class="anchor" id="ch4s1s9_compconn"></a>
4.1.9 Compartmental Connections</h2>
<dl class="section author"><dt>Author</dt><dd>Stanislav Listopad </dd>
<dd>
Michael Beyeler</dd></dl>
<p>Multi-compartment neurons can be connected with <a class="el" href="classCARLsim.html#a7ce184c0de7c3d3c80b27a1ea7bb3e59" title="make a compartmental connection between two compartmentally enabled groups Note: all compartmentally ...">CARLsim::connectCompartments</a>. This creates a "one-to-one" connection between two compartmentally enabled groups <code>grpIdLower</code> and <code>grpIdUpper</code>:</p>
<div class="fragment"><div class="line"><span class="keywordtype">short</span> <span class="keywordtype">int</span> cId = sim.connectCompartments(grpIdLower, grpIdUpper);</div>
</div><!-- fragment --><p>The order of the group IDs in this function call is crucial, as it will define the topography of the network: A compartment can have a <em>down</em> ("mother") and several <em>up</em> ("daughter") compartments, as shown in the following figure:</p>
<div class="image">
<img src="4_compartments.jpg" alt=""/>
<div class="caption">
Example of a network with 4-compartment neurons.</div></div>
<p>The network spans four groups (<code>grpSoma</code>, <code>grpDend0</code>, <code>grpDend1</code>, and <code>grpDend2</code>) of five neurons each. Each neuron in the network (labeled 0-19) is considered a compartment, with all neurons in a group belonging to the same type of compartment (e.g., somatic compartment, <code>grpSoma</code>). All the n-th neurons in a group together form one multi-compartment neuron (e.g., neuron 0, 5, 10, and 15).</p>
<p>According to (9) in <a class="el" href="ch3_neurons_synapses_groups.html#ch3s1s3_compartments">3.1.3 Multi-Compartment Neurons</a>, the dendritic current of neuron 10, <img class="formulaInl" alt="$i_{10}$" src="form_64.png" width="20" height="15"/>, is thus given as:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} i_{10} = &amp; G_0^{down} (v_{10} - v_{0}) + G_5^{down} (v_{10} - v_{5}) + G_{15}^{up} (v_{10} - v_{15}), &amp; \text{(1)} \end{align*}" src="form_65.png" width="473" height="21"/>
</p>
<p>where <img class="formulaInl" alt="$v_n$" src="form_66.png" width="18" height="11"/> is the membrane potential of the n-th neuron, <img class="formulaInl" alt="$G_n^{down}$" src="form_67.png" width="44" height="20"/> is the coupling constant that applies to all <em>downward</em> connections of the n-th neuron, and <img class="formulaInl" alt="$G_n^{up}$" src="form_68.png" width="28" height="18"/> is the coupling constant that applies to all <em>downward</em> connections of the n-th neuron. The coupling constants are set via <a class="el" href="classCARLsim.html#adb7dd274136fd2a3307c0f7f0767275a" title="Sets coupling constants G_u and G_d for the compartment.">CARLsim::setCompartmentParameters</a>.</p>
<p>A group can have at most 4 compartmental neighbors.</p>
<p>The following code configures a network to create the network topography for the figure above:</p>
<div class="fragment"><div class="line"><span class="comment">// ---------------- CONFIG STATE -------------------</span></div>
<div class="line"><a class="code" href="classCARLsim.html">CARLsim</a> sim(<span class="stringliteral">&quot;compartments&quot;</span>, <a class="code" href="carlsim__datastructures_8h.html#a625c4eced5cd956404990e73f3950258a0b5ee5e90bb225a562d92e4078ad9728">GPU_MODE</a>, <a class="code" href="carlsim__datastructures_8h.html#a3a04fc42e22f436d2b3809236cb6ec54ae2d30a195cee6b2961cc2c23ea4b520b">USER</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// create neuron groups</span></div>
<div class="line"><span class="keywordtype">int</span> grpSoma = sim.createGroup(<span class="stringliteral">&quot;soma&quot;</span>, 5, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line"><span class="keywordtype">int</span> grpDend0 = sim.createGroup(<span class="stringliteral">&quot;dendrite0&quot;</span>, 5, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line"><span class="keywordtype">int</span> grpDend1 = sim.createGroup(<span class="stringliteral">&quot;dendrite1&quot;</span>, 5, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line"><span class="keywordtype">int</span> grpDend2 = sim.createGroup(<span class="stringliteral">&quot;dendrite2&quot;</span>, 5, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// set (arbitrary) values for 9-param Izhikevich model</span></div>
<div class="line">sim.setNeuronParameters(grpSoma, 550.0f, 2.0f, -60.0f, -50.0f, 0.002f, -0.4f, 25.0f, -52.2f, 109.0f);</div>
<div class="line">sim.setNeuronParameters(grpDend0, 550.0f, 2.0f, -60.0f, -50.0f, 0.002f, -0.4f, 25.0f, -52.2f, 109.0f);</div>
<div class="line">sim.setNeuronParameters(grpDend1, 550.0f, 2.0f, -60.0f, -50.0f, 0.002f, -0.4f, 25.0f, -52.2f, 109.0f);</div>
<div class="line">sim.setNeuronParameters(grpDend2, 550.0f, 2.0f, -60.0f, -50.0f, 0.002f, -0.4f, 25.0f, -52.2f, 109.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// set (arbitrary) values for up and down coupling</span></div>
<div class="line">sim.setCompartmentParameters(grpSoma, 100.0f, 5.0f); <span class="comment">// up, down</span></div>
<div class="line">sim.setCompartmentParameters(grpDend0, 100.0f, 5.0f); <span class="comment">// up, down</span></div>
<div class="line">sim.setCompartmentParameters(grpDend1, 100.0f, 5.0f); <span class="comment">// up, down</span></div>
<div class="line">sim.setCompartmentParameters(grpDend2, 100.0f, 5.0f); <span class="comment">// up, down</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// create topography</span></div>
<div class="line">sim.connectCompartments(grpSoma, grpDend0);</div>
<div class="line">sim.connectCompartments(grpDend0, grpDend1);</div>
<div class="line">sim.connectCompartments(grpDend0, grpDend2);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>A compartmental connection is basically a gap junction (see (9) in <a class="el" href="ch3_neurons_synapses_groups.html#ch3s1s3_compartments">3.1.3 Multi-Compartment Neurons</a>). </dd>
<dd>
Make sure to call <a class="el" href="classCARLsim.html#adb7dd274136fd2a3307c0f7f0767275a" title="Sets coupling constants G_u and G_d for the compartment.">CARLsim::setCompartmentParameters</a> on a compartmentally connected group. </dd>
<dd>
The maximum number of allowed compartmental connections per neuron is controlled by the parameter <a class="el" href="carlsim__definitions_8h.html#a78ef818f7665dc1c09796a2242be6c9b">MAX_NUM_COMP_CONN</a> in <a class="el" href="carlsim__definitions_8h.html">carlsim_definitions.h</a>. </dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Two compartmentally connected groups must have the same size. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>v3.1</dd></dl>
<h1><a class="anchor" id="ch4s2_library_tools"></a>
4.2. Library Tools</h1>
<p>A library of useful <a class="el" href="classConnectionGenerator.html">ConnectionGenerator</a> subclasses will be added in a future release.</p>
<h1><a class="anchor" id="ch4s3_user_defined"></a>
4.3 User-Defined Connections</h1>
<dl class="section author"><dt>Author</dt><dd>Michael Beyeler</dd></dl>
<p>The pre-defined topologies described above are useful for many simulations, but are insufficient for constructing networks with arbitrary connectivity. Thus, if one is not satisfied with the built-in connection types, a callback mechanism is available for user-specified connectivity.</p>
<p>In the callback mechanism, the simulator calls a method on a user-defined class in order to determine whether a synaptic connection should be made or not. The user simply needs to define a method that specifies whether a connection should be made between a pre-synaptic neuron and a post-synaptic neuron and the simulator will automatically call the method for all possible pre- and post-synaptic pairs. The user can then specify the connection's delay, initial weight, maximum weight, and whether or not it is plastic.</p>
<p>To make a user-defined connection, the user starts by making a new class that derives from the <a class="el" href="classConnectionGenerator.html">ConnectionGenerator</a> class. Inside this new class, the user defines a connect method.</p>
<p>The following code snippet shows a simple example that creates a one-to-one connection with 10% connection probability: </p><div class="fragment"><div class="line"><span class="comment">// FILE: main.cpp</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span>     <span class="comment">// srand, rand</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// custom ConnectionGenerator</span></div>
<div class="line"><span class="keyword">class </span>MyConnection : <span class="keyword">public</span> <a class="code" href="classConnectionGenerator.html">ConnectionGenerator</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    MyConnection() {}</div>
<div class="line">    ~MyConnection() {}</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// the pure virtual function inherited from base class</span></div>
<div class="line">    <span class="comment">// note that weight, maxWt, delay, and connected are passed by reference</span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="classConnectionGenerator.html#acc48aef1290ee3761db2fad5011abab8">connect</a>(<a class="code" href="classCARLsim.html">CARLsim</a>* sim, <span class="keywordtype">int</span> srcGrp, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> destGrp, <span class="keywordtype">int</span> j, <span class="keywordtype">float</span>&amp; weight, <span class="keywordtype">float</span>&amp; maxWt,</div>
<div class="line">            <span class="keywordtype">float</span>&amp; delay, <span class="keywordtype">bool</span>&amp; connected)) {</div>
<div class="line">        <span class="comment">// connect n-th neuron in pre to n-th neuron in post (with 10% prob)</span></div>
<div class="line">        connected = (i==j) &amp;&amp; (rand()/RAND_MAX &lt; 0.1f);</div>
<div class="line">        weight = 1.0f;</div>
<div class="line">        maxWt = 1.0f;</div>
<div class="line">        delay = 1;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="comment">// initialize random seed</span></div>
<div class="line">    srand (time(NULL));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// config some network</span></div>
<div class="line">    <a class="code" href="classCARLsim.html">CARLsim</a> sim(<span class="stringliteral">&quot;example&quot;</span>, <a class="code" href="carlsim__datastructures_8h.html#a625c4eced5cd956404990e73f3950258a729ca642c452f8a7c53df4a48f240537">CPU_MODE</a>, <a class="code" href="carlsim__datastructures_8h.html#a3a04fc42e22f436d2b3809236cb6ec54ae2d30a195cee6b2961cc2c23ea4b520b">USER</a>);</div>
<div class="line">    <span class="keywordtype">int</span> g0 = sim.createGroup(<span class="stringliteral">&quot;g0&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line">    <span class="keywordtype">int</span> g1 = sim.createGroup(<span class="stringliteral">&quot;g1&quot;</span>, 10, <a class="code" href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a>);</div>
<div class="line">    <span class="comment">// ... etc. ...</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// create an instance of MyConnection class and pass it to CARLsim::connect</span></div>
<div class="line">    MyConnection* myConn = <span class="keyword">new</span> MyConnection;</div>
<div class="line">    sim.connect(g0, g1, myConn, <a class="code" href="carlsim__definitions_8h.html#a9baa3423c83e97f02e68daccf466ed4d">SYN_PLASTIC</a>);</div>
<div class="line"> </div>
<div class="line">    sim.setupNetwork();</div>
<div class="line">    <span class="comment">// etc.</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>Note that within <a class="el" href="classConnectionGenerator.html#acc48aef1290ee3761db2fad5011abab8" title="specifies which synaptic connections (per group, per neuron, per synapse) should be made">ConnectionGenerator::connect</a> it is possible to access any public methods of the <a class="el" href="classCARLsim.html" title="CARLsim User Interface This class provides a user interface to the public sections of CARLsimCore sou...">CARLsim</a> class. This makes it possible to, for example, create a custom connection function that takes into account the relative position of neurons (using <a class="el" href="classCARLsim.html#aba1eac7ee46971637423204a63e9892b" title="returns the 3D location a neuron codes for">CARLsim::getNeuronLocation3D</a>). The following code snippet slightly adjusts the above code snippet to produce topographic one-to-one connectivity; that is, neurons are only connected if their 3D coordinates are exactly the same. </p><div class="fragment"><div class="line"><span class="comment">// custom ConnectionGenerator</span></div>
<div class="line"><span class="keyword">class </span>MyConnection : <span class="keyword">public</span> <a class="code" href="classConnectionGenerator.html">ConnectionGenerator</a> {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ...</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// </span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="classConnectionGenerator.html#acc48aef1290ee3761db2fad5011abab8">connect</a>(<a class="code" href="classCARLsim.html">CARLsim</a>* sim, <span class="keywordtype">int</span> srcGrp, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> destGrp, <span class="keywordtype">int</span> j, <span class="keywordtype">float</span>&amp; weight, <span class="keywordtype">float</span>&amp; maxWt,</div>
<div class="line">            <span class="keywordtype">float</span>&amp; delay, <span class="keywordtype">bool</span>&amp; connected)) {</div>
<div class="line">        <a class="code" href="structPoint3D.html">Point3D</a> pre = sim-&gt;getNeuronLocation3D(srcGrp, i);</div>
<div class="line">        <a class="code" href="structPoint3D.html">Point3D</a> post = sim-&gt;getNeuronLocation3D(destGrp, j);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// connect only if pre and post coordinates are identical (with 10% prob)</span></div>
<div class="line">        connected = (pre == post) &amp;&amp; (rand()/RAND_MAX &lt; 0.1f);</div>
<div class="line">        weight = 1.0f;</div>
<div class="line">        maxWt = 1.0f;</div>
<div class="line">        delay = 1;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>All weight values should be non-negative (equivalent to weight <b>magnitudes</b>), even for inhibitory connections. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>CARLsim::connect(int, int, ConnectionGenerator*, bool, int, int) </dd>
<dd>
CARLsim::connect(int, int, ConnectionGenerator*, float, float, bool, int, int)</dd></dl>
<h1><a class="anchor" id="ch4s4_migrating_connect"></a>
4.4 Migrating from CARLsim 2.2</h1>
<dl class="section author"><dt>Author</dt><dd>Michael Beyeler</dd></dl>
<p>Please note that the signature of the <a class="el" href="classCARLsim.html#a30b16b93d57551dcde0559e8a4e98e27" title="Connects a presynaptic to a postsynaptic group using fixed/plastic weights and a range of delay value...">CARLsim::connect</a> call has changed since <a class="el" href="classCARLsim.html" title="CARLsim User Interface This class provides a user interface to the public sections of CARLsimCore sou...">CARLsim</a> 2.2 in order to avoid confusion concerning the large number of (float) input arguments.</p><ul>
<li>Inhibitory synaptic weights are no longer specified with a negative sign. Instead, the <a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight</a> struct accepts non-negative weight <b>magnitudes</b>. The same applies to user-defined connections. Connections with minimum weight <code>minWt</code>, initial weight <code>initWt</code>, and maximum weight <code>maxWt</code> in 2.2 translate to <code><a class="el" href="structRangeWeight.html" title="a range struct for synaptic weight magnitudes">RangeWeight</a>(fabs(minWt),fabs(initWt),fabs(maxWt))</code> in 3.0, where <code>fabs</code> returns the absolute value of a <code>float</code>, and <code>minWt</code> must always be zero (for now).</li>
<li>Delays are no longer specified as two <code>uint8_t</code> variables. Instead, the <a class="el" href="structRangeDelay.html" title="a range struct for synaptic delays">RangeDelay</a> struct accepts a lower and upper bound for the delay range. Connections with minimum delay <code>minDelay</code> and maximum delay <code>maxDelay</code> in 2.2 translate to <code><a class="el" href="structRangeDelay.html" title="a range struct for synaptic delays">RangeDelay(minDelay,maxDelay)</a></code> in 3.0.</li>
<li>The optional input argument <code>const string&amp; wtType</code> is no longer supported.</li>
<li>In addition, 3.0 now provides means to specify spatial receptive fields (see <a class="el" href="ch4_connections.html#ch4s1s3_radiusRF">4.1.3 The RadiusRF Struct</a>) and receptor-specific synaptic gain factors (see <a class="el" href="ch4_connections.html#ch4s1s4_receptor_gain">4.1.4 Synaptic Receptor-Specific Gain Factors</a>). </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="acarlsim__datastructures_8h_html_a625c4eced5cd956404990e73f3950258a0b5ee5e90bb225a562d92e4078ad9728"><div class="ttname"><a href="carlsim__datastructures_8h.html#a625c4eced5cd956404990e73f3950258a0b5ee5e90bb225a562d92e4078ad9728">GPU_MODE</a></div><div class="ttdeci">@ GPU_MODE</div><div class="ttdoc">model is run on GPU card(s)</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__datastructures_8h_source.html#l00115">carlsim_datastructures.h:115</a></div></div>
<div class="ttc" id="aclassConnectionGenerator_html_acc48aef1290ee3761db2fad5011abab8"><div class="ttname"><a href="classConnectionGenerator.html#acc48aef1290ee3761db2fad5011abab8">ConnectionGenerator::connect</a></div><div class="ttdeci">virtual void connect(CARLsim *s, int srcGrpId, int i, int destGrpId, int j, float &amp;weight, float &amp;maxWt, float &amp;delay, bool &amp;connected)=0</div><div class="ttdoc">specifies which synaptic connections (per group, per neuron, per synapse) should be made</div></div>
<div class="ttc" id="aclassConnectionGenerator_html"><div class="ttname"><a href="classConnectionGenerator.html">ConnectionGenerator</a></div><div class="ttdef"><b>Definition:</b> <a href="callback_8h_source.html#l00090">callback.h:90</a></div></div>
<div class="ttc" id="astructRangeWeight_html"><div class="ttname"><a href="structRangeWeight.html">RangeWeight</a></div><div class="ttdoc">a range struct for synaptic weight magnitudes</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__datastructures_8h_source.html#l00311">carlsim_datastructures.h:311</a></div></div>
<div class="ttc" id="acarlsim__definitions_8h_html_a71b1b059a7ff0783d39e22b9b1028d90"><div class="ttname"><a href="carlsim__definitions_8h.html#a71b1b059a7ff0783d39e22b9b1028d90">EXCITATORY_NEURON</a></div><div class="ttdeci">#define EXCITATORY_NEURON</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__definitions_8h_source.html#l00077">carlsim_definitions.h:76</a></div></div>
<div class="ttc" id="acarlsim__datastructures_8h_html_a3a04fc42e22f436d2b3809236cb6ec54ae2d30a195cee6b2961cc2c23ea4b520b"><div class="ttname"><a href="carlsim__datastructures_8h.html#a3a04fc42e22f436d2b3809236cb6ec54ae2d30a195cee6b2961cc2c23ea4b520b">USER</a></div><div class="ttdeci">@ USER</div><div class="ttdoc">User mode, for experiment-oriented simulations.</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__datastructures_8h_source.html#l00091">carlsim_datastructures.h:91</a></div></div>
<div class="ttc" id="astructRangeDelay_html"><div class="ttname"><a href="structRangeDelay.html">RangeDelay</a></div><div class="ttdoc">a range struct for synaptic delays</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__datastructures_8h_source.html#l00278">carlsim_datastructures.h:278</a></div></div>
<div class="ttc" id="acarlsim__datastructures_8h_html_a625c4eced5cd956404990e73f3950258a729ca642c452f8a7c53df4a48f240537"><div class="ttname"><a href="carlsim__datastructures_8h.html#a625c4eced5cd956404990e73f3950258a729ca642c452f8a7c53df4a48f240537">CPU_MODE</a></div><div class="ttdeci">@ CPU_MODE</div><div class="ttdoc">model is run on CPU core(s)</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__datastructures_8h_source.html#l00114">carlsim_datastructures.h:114</a></div></div>
<div class="ttc" id="aclassCARLsim_html"><div class="ttname"><a href="classCARLsim.html">CARLsim</a></div><div class="ttdoc">CARLsim User Interface This class provides a user interface to the public sections of CARLsimCore sou...</div><div class="ttdef"><b>Definition:</b> <a href="carlsim_8h_source.html#l00137">carlsim.h:137</a></div></div>
<div class="ttc" id="astructPoint3D_html"><div class="ttname"><a href="structPoint3D.html">Point3D</a></div><div class="ttdoc">a point in 3D space</div><div class="ttdef"><b>Definition:</b> <a href="linear__algebra_8h_source.html#l00057">linear_algebra.h:57</a></div></div>
<div class="ttc" id="acarlsim__definitions_8h_html_a9baa3423c83e97f02e68daccf466ed4d"><div class="ttname"><a href="carlsim__definitions_8h.html#a9baa3423c83e97f02e68daccf466ed4d">SYN_PLASTIC</a></div><div class="ttdeci">#define SYN_PLASTIC</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__definitions_8h_source.html#l00061">carlsim_definitions.h:60</a></div></div>
<div class="ttc" id="acarlsim__definitions_8h_html_a40e0573abfe33884cbdaae75b5971955"><div class="ttname"><a href="carlsim__definitions_8h.html#a40e0573abfe33884cbdaae75b5971955">SYN_FIXED</a></div><div class="ttdeci">#define SYN_FIXED</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__definitions_8h_source.html#l00060">carlsim_definitions.h:59</a></div></div>
<div class="ttc" id="astructRadiusRF_html"><div class="ttname"><a href="structRadiusRF.html">RadiusRF</a></div><div class="ttdoc">A struct to specify the receptive field (RF) radius in 3 dimensions.</div><div class="ttdef"><b>Definition:</b> <a href="carlsim__datastructures_8h_source.html#l00363">carlsim_datastructures.h:363</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Jul 11 2020 19:24:13 for CARLsim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
